

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.14. Packages and subprograms &#8212; Real-time and embedded data systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part-vhdl/vhdl_packages_subprograms';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Embedded systems" href="../part-embedded/embedded_intro.html" />
    <link rel="prev" title="2.13. State machines" href="vhdl_state_machines.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/fys4220_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/fys4220_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_agenda.html">Weekly agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_content_overview.html">Content and learning objectives</a></li>

<li class="toctree-l1"><a class="reference internal" href="../part-information/information_tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_download_tools.html">Quartus and ModelSim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_prepare_git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Other resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.uio.no/FYS4220-2023">Github organization page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.uio.no/orgs/FYS4220-2023/discussions">Discussion forum</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Main content</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-fpga/fpga.html">1. FPGA technology</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-fpga/pld_introduction.html">1.1. Programmable logic devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-fpga/fpga_introduction.html">1.2. Field Programmable Gate Arrays</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="vhdl.html">2. VHDL</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vhdl_history.html">2.2. History</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_design_units.html">2.3. Design units and structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_design_flow.html">2.4. Design flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_objects_data_types.html">2.5. Objects and data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_operators.html">2.6. Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_concurrent_statements.html">2.7. Concurrent statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_description_models.html">2.8. Description styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_testbenches.html">2.9. Testbenches</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_process.html">2.10. VHDL Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_metastability.html">2.11. Metastability and synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_generics.html">2.12. Generic map</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_state_machines.html">2.13. State machines</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.14. Packages and subprograms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-embedded/embedded_intro.html">3. Embedded systems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_nios2.html">3.1. Nios II CPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_softcore.html">3.2. Soft core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_memory_mapped.html">3.3. Memory mapped interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_hal.html">3.4. Hardware Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_nios2_system_development.html">3.5. Nios II system development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_interrupt.html">3.6. Interrupt handling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-rtos/rtos_intro.html">4. RTOS</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_ucosii.html">4.1. uC/OS-II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_tasks.html">4.2. Scheduling and task management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_latency_jitter.html">4.3. Latency &amp; jitter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../part-rtos/rtos_intertask_communication.html">4.4. Intertask communication</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_semaphores.html">4.4.1. Semaphores</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_priority_inversion.html">4.4.2. Priority inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_messages.html">4.4.3. Messages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-exercises/exercises_intro.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_vhdl.html">VHDL</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_your_first_fpga_project.html">EX1: Your first FPGA project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_adder.html">EX2: Adder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_counter.html">EX3: 4-bit up-counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_state_machine.html">EX4: State machine</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_embedded.html">Embedded systems</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_nios2_example.html">EX5: A basic Nios II system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_memory_mapped_sw.html">EX6: Accessing Nios II memory mapped modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_nios2_interrupt.html">EX7: Nios II interrupt handling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_rtos.html">RTOS</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_rtos_basic_example.html">EX8: A basic RTOS application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_rtos_semaphores_example.html">EX9: Semaphore example</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_intro.html">Project overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_uart.html">P1: UART controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_nios2.html">P2: Microcontroller system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/data_rate.html">P3: RTOS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part-vhdl/vhdl_packages_subprograms.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Packages and subprograms</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">2.14.1. Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subprograms">2.14.2. Subprograms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">2.14.2.1. Procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function">2.14.2.2. Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-package">2.14.3. Example of package</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.14.3.1. Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vhdl-package-example-procedure">2.14.3.2. Procedure</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supporting-videos">2.14.4. Supporting videos</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="packages-and-subprograms">
<span id="vhdl-packages"></span><h1><span class="section-number">2.14. </span>Packages and subprograms<a class="headerlink" href="#packages-and-subprograms" title="Permalink to this heading">#</a></h1>
<section id="packages">
<h2><span class="section-number">2.14.1. </span>Packages<a class="headerlink" href="#packages" title="Permalink to this heading">#</a></h2>
<p>Packages in VHDL provide an important way of organzing commonly used objects, data types, component declarations, signals and subprograms (function, procedure) that can be shared among different VHDL design units. It is simply a way of grouping a collection of related declarations that serve a common purpose. In this way you avoid repeating declarations as well as reducing the probability of mistakes. The <em>ieee.std_logic_1164</em> is one example of a predefined package in VHDL. It is also possible to write user defined packages. If multiple VHDL design units tend to use the same declarations, it may be favorable to create your own package that can be easily reused for future designs. The package can be placed in a separate VHDL file and referenced via the keyword <code class="docutils literal notranslate"><span class="pre">use</span></code> and the library to which the package has been compiled, typically the <code class="docutils literal notranslate"><span class="pre">work</span></code> library.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">use</span><span class="w"> </span><span class="nn">work.user_pkg.</span><span class="k">all</span><span class="p">;</span>
</pre></div>
</div>
<p>A package consists of a <em>declaration</em> part and a <em>body</em>. The package declaration specifies the external view while the implementation is defined in the package body.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span>library ieee;
use ieee.std_logic_1164.all;

package &lt;identifer&gt; is
-- Declaration
end [package] [identifier];

package body &lt;package name&gt; is
-- Implementation
end [package] [identifier];
</pre></div>
</div>
</section>
<section id="subprograms">
<h2><span class="section-number">2.14.2. </span>Subprograms<a class="headerlink" href="#subprograms" title="Permalink to this heading">#</a></h2>
<p>When writing complex VHDL descriptions it can be useful to divide or structure the code into manageable smaller units or sections. Structuring the code into design units is one such approach, but VHDL also provides <em>subprograms</em> for this purpose. Subprograms are a mechanism for representing commonly used logic functions or sequential statements. VHDL has two kinds of subprograms, <em>functions</em> and <em>procedures</em>. These are most commonly defined or declared in a package, but can also be defined in the declaration part of an architecture or process. Statements within a subprogram are sequential regardless of where the subprogram is invoked. It may be useful to think of subprograms as processes that operate only on their inputs, and for the case of procedures on their outputs.</p>
<section id="procedure">
<span id="vhdl-packages-procedure"></span><h3><span class="section-number">2.14.2.1. </span>Procedure<a class="headerlink" href="#procedure" title="Permalink to this heading">#</a></h3>
<p>A procedure can be used to define an algorithm and is widely use to ease the writing and structuring of test benches.
The procedure accepts constants, variables, and signals as object classes in its parameter list. Objects in the parameter list is separated with <code class="docutils literal notranslate"><span class="pre">;</span></code>. If the object class is not specified, a variable or constant is assumed depending on the mode (if <code class="docutils literal notranslate"><span class="pre">in</span></code> it is a constant, if <code class="docutils literal notranslate"><span class="pre">out</span></code>/<code class="docutils literal notranslate"><span class="pre">inout</span></code> it is a variable). Objects in the parameter list can have modes <code class="docutils literal notranslate"><span class="pre">in</span></code>, <code class="docutils literal notranslate"><span class="pre">out</span></code>, or <code class="docutils literal notranslate"><span class="pre">inout</span></code>. If the mode is not specified the default is <code class="docutils literal notranslate"><span class="pre">in</span></code>. A procedure does not return a value, but may change the values of the parameters passed to them. Procedures are synthesizable, provided that they do not detect clock edges or contain wait statements, i.e., they must not infer registers, but describe combinational logic. However, procedures are mostly used for test benches.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span>procedure &lt;identifier&gt; [ ( formal_parameter_list ) ] is
-- subprogram declaration part
begin
-- sequential statement
end [procedure] [identifier]
</pre></div>
</div>
</section>
<section id="function">
<h3><span class="section-number">2.14.2.2. </span>Function<a class="headerlink" href="#function" title="Permalink to this heading">#</a></h3>
<p>A function is an expression that defines a sequential algorithm that computes of a value to be returned. It can produce only one return value and must contain a return statement. A function can only use parameters of type constant or signal with mode <em>in</em>, and cannot change the values of the parameters passed in the parameter list. Objects in the parameter list is separated with <code class="docutils literal notranslate"><span class="pre">;</span></code>. If the object class is not specified it is assumed to be of type constant and mode <em>in</em>. When a function is called, the parameters are given the values of the actual parameters. Wait statements cannot be used in functions (functions execute in zero simulation time). Functions are most commonly used for describing combinational logic, type conversions, or defining the meaning of an operator for a new type.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span>function &lt;identifier&gt; [ ( formal_parameter_list ) ]  return &lt;type&gt; is
-- subprogram declaration part
begin
-- sequential statement
end [function] [identifier]
</pre></div>
</div>
</section>
</section>
<section id="example-of-package">
<h2><span class="section-number">2.14.3. </span>Example of package<a class="headerlink" href="#example-of-package" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3><span class="section-number">2.14.3.1. </span>Function<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>The example below shows how function can be used to describe the binary coded decimal to 7-segment decoder. This is typical example of a logic function that e.g., can be declared in a package for easy reuse.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Library and package part</span>
<span class="k">library</span><span class="w"> </span><span class="nn">ieee</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nn">ieee.std_logic_1164.</span><span class="k">all</span><span class="p">;</span>

<span class="k">package</span><span class="w"> </span><span class="n">user_pkg</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="c1">-- The function needs to be declared here to be visible outside the package</span>
<span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="n">bcd2seg7</span><span class="p">(</span><span class="k">signal</span><span class="w"> </span><span class="n">bcd</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">package</span><span class="p">;</span>

<span class="k">package</span><span class="w"> </span><span class="k">body</span><span class="w"> </span><span class="n">user_pkg</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="c1">-- implementation details of BCD to 7-segment decoder</span>
<span class="w">  </span><span class="k">begin</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">bcd</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0000&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;01000000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0001&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;01111001&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0010&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00100100&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0011&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00110000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0100&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00011001&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0101&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00010010&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0110&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00000010&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;0111&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;01111000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1000&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00000000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1001&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00010000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1010&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00001000&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1011&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00000011&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1100&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;01000110&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1101&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00100001&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1110&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00000110&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="s">&quot;1111&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;00001110&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="k">others</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;01111111&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
<p>In the main design entity this function can be used as demonstrated below.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Library and package part</span>
<span class="k">library</span><span class="w"> </span><span class="nn">ieee</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nn">ieee.std_logic_1164.</span><span class="k">all</span><span class="p">;</span>
<span class="c1">-- include user defined package</span>
<span class="k">use</span><span class="w"> </span><span class="nn">work.user_pkg.</span><span class="k">all</span><span class="p">;</span>

<span class="c1">-- entity description</span>
<span class="k">entity</span><span class="w"> </span><span class="nc">example</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="k">port</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">sw</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w">  </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">hex0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="c1">-- 7-segment display</span>
<span class="w">    </span><span class="p">);</span>
<span class="k">end</span><span class="w"> </span><span class="k">entity</span><span class="w"> </span><span class="nc">example</span><span class="p">;</span>


<span class="c1">-- architecture</span>
<span class="k">architecture</span><span class="w"> </span><span class="nc">rtl</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">example</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="c1">-- declartion area</span>

<span class="k">begin</span>
<span class="w">  </span><span class="c1">-- make use of function declared and implemented in user_pkg.vhd</span>
<span class="w">  </span><span class="n">hex0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">bcd2seg7</span><span class="p">(</span><span class="n">sw</span><span class="p">);</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="vhdl-package-example-procedure">
<span id="id2"></span><h3><span class="section-number">2.14.3.2. </span>Procedure<a class="headerlink" href="#vhdl-package-example-procedure" title="Permalink to this heading">#</a></h3>
<p>The example below shows how a procedure can be declared in a package and used to automate the test stimuli on the input of a RX UART module.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">library</span><span class="w"> </span><span class="nn">ieee</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nn">ieee.std_logic_1164.</span><span class="k">all</span><span class="p">;</span>

<span class="k">package</span><span class="w"> </span><span class="n">tb_support_pkg</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">constant</span><span class="w"> </span><span class="n">GC_SYSTEM_CLK</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">50</span><span class="n">_000_000</span><span class="p">;</span>
<span class="w">  </span><span class="k">constant</span><span class="w"> </span><span class="n">GC_BAUD_RATE</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">115</span><span class="n">_200</span><span class="p">;</span>

<span class="w">  </span><span class="c1">--clock generation parameters</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">clk_enable</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span>
<span class="w">  </span><span class="k">constant</span><span class="w"> </span><span class="n">clk_period</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">time</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="n">ns</span><span class="p">;</span>
<span class="w">  </span><span class="k">constant</span><span class="w"> </span><span class="n">C_BIT_PERIOD</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">time</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">clk_period</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">GC_SYSTEM_CLK</span><span class="o">/</span><span class="n">GC_BAUD_RATE</span><span class="p">;</span>

<span class="w">  </span><span class="c1">-- Support procedure to write serial data</span>
<span class="w">  </span><span class="k">procedure</span><span class="w"> </span><span class="n">uart_write_data</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">-- data</span>
<span class="w">    </span><span class="k">signal</span><span class="w"> </span><span class="n">serial_data</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- serial RX line out</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">inject_error_stop_bit</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Error in stop bit</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">inject_error_start_bit</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">false</span><span class="w"> </span><span class="c1">-- Error in start bit</span>
<span class="w">  </span><span class="p">);</span>

<span class="k">end</span><span class="w"> </span><span class="k">package</span><span class="p">;</span>

<span class="k">package</span><span class="w"> </span><span class="k">body</span><span class="w"> </span><span class="n">tb_support_pkg</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="c1">-- Support procedure to write serial data</span>
<span class="w">  </span><span class="k">procedure</span><span class="w"> </span><span class="n">uart_write_data</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">-- data</span>
<span class="w">    </span><span class="k">signal</span><span class="w"> </span><span class="n">serial_data</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- serial RX line out</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">inject_error_stop_bit</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Error in stop bit</span>
<span class="w">    </span><span class="k">constant</span><span class="w"> </span><span class="n">inject_error_start_bit</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">false</span><span class="w"> </span><span class="c1">-- Error in start bit</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="k">begin</span>

<span class="w">    </span><span class="c1">-- Send start bit with or without error</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">inject_error_start_bit</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">C_BIT_PERIOD</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- Send the data bits LSB first</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">bit_pos</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">data</span><span class="na">&#39;length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">loop</span>
<span class="w">      </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">bit_pos</span><span class="p">);</span>
<span class="w">      </span><span class="c1">--report &quot;Writint bit &quot; &amp; integer&#39;image(bit_pos) &amp; &quot; of value &quot; &amp; std_logic&#39;image(data(bit_pos)) ;</span>
<span class="w">      </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">C_BIT_PERIOD</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">loop</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- Send stop bit with or without error</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">inject_error_stop_bit</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">C_BIT_PERIOD</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- Return to default value for RX.</span>
<span class="w">    </span><span class="n">serial_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">procedure</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
<p>The procedure <em>uart_write_data</em> can then be easily used in the stimuli process of the main test bench.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">library</span><span class="w"> </span><span class="nn">ieee</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nn">ieee.std_logic_1164.</span><span class="k">all</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nn">work.tb_support_pkg.</span><span class="k">all</span><span class="p">;</span>

<span class="k">entity</span><span class="w"> </span><span class="nc">rx_uart_tb</span><span class="w"> </span><span class="k">is</span>
<span class="k">end</span><span class="w"> </span><span class="k">entity</span><span class="p">;</span>

<span class="k">architecture</span><span class="w"> </span><span class="nc">tb</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">rx_uart_tb</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">areset_n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">rx_data</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">rx_data_valid</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">rx_busy</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">rx</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">rx_err</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span>

<span class="k">begin</span>
<span class="w">  </span><span class="c1">-- create the system clock</span>
<span class="w">  </span><span class="n">clk</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">clk_period</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">clk_enable</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1">-- include the dut</span>
<span class="w">  </span><span class="n">dut</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">entity</span><span class="w"> </span><span class="nc">work</span><span class="p">.</span><span class="n">rx_uart</span><span class="p">(</span><span class="n">rtl</span><span class="p">)</span>
<span class="w">    </span><span class="k">generic</span><span class="w"> </span><span class="k">map</span><span class="p">(</span>
<span class="w">      </span><span class="n">GC_SYSTEM_CLK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GC_SYSTEM_CLK</span><span class="p">,</span>
<span class="w">      </span><span class="n">GC_BAUD_RATE</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GC_BAUD_RATE</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">port</span><span class="w"> </span><span class="k">map</span><span class="p">(</span>
<span class="w">      </span><span class="n">clk</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span>
<span class="w">      </span><span class="n">areset_n</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">areset_n</span><span class="p">,</span>
<span class="w">      </span><span class="n">rx_data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rx_data</span><span class="p">,</span>
<span class="w">      </span><span class="n">rx_busy</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rx_busy</span><span class="p">,</span>
<span class="w">      </span><span class="n">rx_err</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rx_err</span><span class="p">,</span>
<span class="w">      </span><span class="n">rx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rx</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">  </span><span class="c1">-- Generate the main test stimuli</span>
<span class="w">  </span><span class="n">p_stimuli</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span>
<span class="w">  </span><span class="k">begin</span>
<span class="w">    </span><span class="n">report</span><span class="w"> </span><span class="s">&quot;Starting simulation of RX UART&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">areset_n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="n">clk_enable</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">ns</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- toggle restet for at least a few clock cycles</span>
<span class="w">    </span><span class="n">areset_n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">clk_period</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">areset_n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">ns</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">-- Write the data 0x55 to the RX input</span>
<span class="w">    </span><span class="n">uart_write_data</span><span class="p">(</span><span class="mh">x&quot;55&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rx</span><span class="p">);</span>
<span class="w">    </span><span class="c1">-- make sure the data has been received and busy is set</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">clk_period</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="c1">-- make sure transaction has been completed</span>
<span class="w">    </span><span class="c1">-- and busy is low before checking received byte</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">rx_busy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="k">wait</span><span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="n">rx_busy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">report</span><span class="w"> </span><span class="s">&quot;rx_busy goes low - new data has been received&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- check if correct value has been received by the rx moduel</span>
<span class="w">    </span><span class="k">assert</span><span class="w"> </span><span class="n">rx_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">x&quot;55&quot;</span><span class="w"> </span><span class="c1">-- report if not equal to expected byte.</span>
<span class="w">    </span><span class="n">report</span><span class="w"> </span><span class="s">&quot;Incorrect byte received!&quot;</span>
<span class="w">      </span><span class="k">severity</span><span class="w"> </span><span class="n">warning</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- Wait some additional time to allow visual inspection in wave diagram</span>
<span class="w">    </span><span class="k">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">ns</span><span class="p">;</span>
<span class="w">    </span><span class="n">clk_enable</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">wait</span><span class="p">;</span>

<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<!--
```{admonition} Supplementary suggested reading:

Chapter 5, section 5.1 in LaMeres {cite}`lameres`.
* [Direct link html-version](https://link-springer-com.ezproxy.uio.no/chapter/10.1007/978-3-030-12489-2_5#Sec1)
* [Direct link pdf-version](https://link.springer.com/content/pdf/10.1007%2F978-3-030-12489-2_5)
```
-->
</section>
</section>
<section id="supporting-videos">
<h2><span class="section-number">2.14.4. </span>Supporting videos<a class="headerlink" href="#supporting-videos" title="Permalink to this heading">#</a></h2>
<p>The following video briefly discusses the use of packages and sub-programs in VHDL.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/e_4ejwJdO9M" title="vhdl package subprograms" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part-vhdl"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="vhdl_state_machines.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.13. </span>State machines</p>
      </div>
    </a>
    <a class="right-next"
       href="../part-embedded/embedded_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Embedded systems</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#packages">2.14.1. Packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subprograms">2.14.2. Subprograms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">2.14.2.1. Procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function">2.14.2.2. Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-package">2.14.3. Example of package</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.14.3.1. Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vhdl-package-example-procedure">2.14.3.2. Procedure</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supporting-videos">2.14.4. Supporting videos</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ketil Røed
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>