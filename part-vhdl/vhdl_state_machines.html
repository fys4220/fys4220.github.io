

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.13. State machines &#8212; Real-time and embedded data systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part-vhdl/vhdl_state_machines';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.14. Packages and subprograms" href="vhdl_packages_subprograms.html" />
    <link rel="prev" title="2.12. Generic map" href="vhdl_generics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/fys4220_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/fys4220_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_agenda.html">Weekly agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_content_overview.html">Content and learning objectives</a></li>

<li class="toctree-l1"><a class="reference internal" href="../part-information/information_tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_download_tools.html">Quartus and ModelSim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-information/information_prepare_git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Other resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.uio.no/FYS4220-2023">Github organization page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.uio.no/orgs/FYS4220-2023/discussions">Discussion forum</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Main content</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-fpga/fpga.html">1. FPGA technology</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-fpga/pld_introduction.html">1.1. Programmable logic devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-fpga/fpga_introduction.html">1.2. Field Programmable Gate Arrays</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="vhdl.html">2. VHDL</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vhdl_history.html">2.2. History</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_design_units.html">2.3. Design units and structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_design_flow.html">2.4. Design flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_objects_data_types.html">2.5. Objects and data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_operators.html">2.6. Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_concurrent_statements.html">2.7. Concurrent statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_description_models.html">2.8. Description styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_testbenches.html">2.9. Testbenches</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_process.html">2.10. VHDL Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_metastability.html">2.11. Metastability and synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_generics.html">2.12. Generic map</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.13. State machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhdl_packages_subprograms.html">2.14. Packages and subprograms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-embedded/embedded_intro.html">3. Embedded systems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_nios2.html">3.1. Nios II CPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_softcore.html">3.2. Soft core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_memory_mapped.html">3.3. Memory mapped interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_hal.html">3.4. Hardware Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_nios2_system_development.html">3.5. Nios II system development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-embedded/embedded_interrupt.html">3.6. Interrupt handling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-rtos/rtos_intro.html">4. RTOS</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_ucosii.html">4.1. uC/OS-II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_tasks.html">4.2. Scheduling and task management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-rtos/rtos_latency_jitter.html">4.3. Latency &amp; jitter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../part-rtos/rtos_intertask_communication.html">4.4. Intertask communication</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_semaphores.html">4.4.1. Semaphores</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_priority_inversion.html">4.4.2. Priority inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part-rtos/rtos_messages.html">4.4.3. Messages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-exercises/exercises_intro.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_vhdl.html">VHDL</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_your_first_fpga_project.html">EX1: Your first FPGA project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_adder.html">EX2: Adder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_counter.html">EX3: 4-bit up-counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_state_machine.html">EX4: State machine</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_embedded.html">Embedded systems</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_nios2_example.html">EX5: A basic Nios II system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_memory_mapped_sw.html">EX6: Accessing Nios II memory mapped modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_nios2_interrupt.html">EX7: Nios II interrupt handling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part-exercises/exercises_rtos.html">RTOS</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_rtos_basic_example.html">EX8: A basic RTOS application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part-exercises/exercises_rtos_semaphores_example.html">EX9: Semaphore example</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_intro.html">Project overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_uart.html">P1: UART controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/project_nios2.html">P2: Microcontroller system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part-project/data_rate.html">P3: RTOS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part-vhdl/vhdl_state_machines.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>State machines</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moore">2.13.1. Moore</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mealy">2.13.2. Mealy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-of-fsms-in-vhdl">2.13.3. Design of FSMs in VHDL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declaration-of-states">2.13.4. Declaration of states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-process-state-machine">2.13.5. One process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-process-state-machine">2.13.6. Two process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-process-state-machine">2.13.7. Three process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supporting-videos">2.13.8. Supporting videos</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="state-machines">
<span id="vhdl-statemachines"></span><h1><span class="section-number">2.13. </span>State machines<a class="headerlink" href="#state-machines" title="Permalink to this heading">#</a></h1>
<p>Finite state machines (FSMs) are used to solved many problems in digital electronics. An FSM is used to model a behaviour composed of a finit number of states, input events, transitions between those states (rules and conditions), and actions. That is, a state machine will read a series of inputs and switch to different states depending on the value of the inputs. Each state specifies which state to switch to for a given input value. A state machine is an effective method for implementing control functionality. In this course we will use it to implement the control state machine for the reciever and transmitter of a UART.</p>
<p>We have already seen how VHDL can be used to describe combinational and synchronous logic where the output only is dependent on the present value of the inputs as seen in <a class="reference internal" href="#fig-vhdl-synchronous"><span class="std std-numref">Fig. 2.48</span></a>.</p>
<figure class="align-center" id="fig-vhdl-synchronous">
<a class="reference internal image-reference" href="../_images/vhdl_synchronous.png"><img alt="../_images/vhdl_synchronous.png" src="../_images/vhdl_synchronous.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.48 </span><span class="caption-text">Synchronous logic.</span><a class="headerlink" href="#fig-vhdl-synchronous" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>However, if we add feedback to the system as seen in <a class="reference internal" href="#fig-vhdl-sequential"><span class="std std-numref">Fig. 2.49</span></a>, the output becomes dependent not only on the present value of the system’s inputs but also on the sequence of past events. This is referred to as sequential logic.</p>
<figure class="align-center" id="fig-vhdl-sequential">
<a class="reference internal image-reference" href="../_images/vhdl_sequential.png"><img alt="../_images/vhdl_sequential.png" src="../_images/vhdl_sequential.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.49 </span><span class="caption-text">Sequential logic.</span><a class="headerlink" href="#fig-vhdl-sequential" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>An FSM design is just a step beyond sequential: the hardware implementation requires <span style="color:blue">a register to store the state value</span>, <span style="color:green">a block of combinational logic to determine the state transition</span>, <span style="color:orange">and a block of combinational logic that determines the output of the FSM</span>. These blocks are illustrated in figure <a class="reference internal" href="#fig-vhdl-statemachine"><span class="std std-numref">Fig. 2.50</span></a>. The current state is stored in registers and updated synchronous to the clock.</p>
<figure class="align-center" id="fig-vhdl-statemachine">
<a class="reference internal image-reference" href="../_images/vhdl_statemachine.png"><img alt="../_images/vhdl_statemachine.png" src="../_images/vhdl_statemachine.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.50 </span><span class="caption-text">State machine block diagram.</span><a class="headerlink" href="#fig-vhdl-statemachine" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>There are two basic types of finite state machine behaviours: <strong>Moore</strong> and <strong>Mealy</strong>.</p>
<section id="moore">
<h2><span class="section-number">2.13.1. </span>Moore<a class="headerlink" href="#moore" title="Permalink to this heading">#</a></h2>
<p>In a Moore type state machine the outputs are a function of the current state only. This corresponds to <a class="reference internal" href="#fig-vhdl-statemachine"><span class="std std-numref">Fig. 2.50</span></a> without the dashed line marked with (MEALY ONLY).</p>
<p>A state diagram of a Moore machine is shown in <a class="reference internal" href="#fig-vhdl-moore-diagram"><span class="std std-numref">Fig. 2.51</span></a> where the circles represent the current state and the arrows represent the transitions between the different states. The labels inside the circles represent the name of the current state and the corresponding output value for that state. The label on the arrow represent the input condition that must be present for the transition to take place.</p>
<figure class="align-center" id="fig-vhdl-moore-diagram">
<a class="reference internal image-reference" href="../_images/vhdl_moore_diagram.png"><img alt="../_images/vhdl_moore_diagram.png" src="../_images/vhdl_moore_diagram.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.51 </span><span class="caption-text">Moore state diagram.</span><a class="headerlink" href="#fig-vhdl-moore-diagram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="mealy">
<h2><span class="section-number">2.13.2. </span>Mealy<a class="headerlink" href="#mealy" title="Permalink to this heading">#</a></h2>
<p>In a Mealy type state machine the outputs are a function not only of the current state but also on all the inputs. This corresponds to <a class="reference internal" href="#fig-vhdl-statemachine"><span class="std std-numref">Fig. 2.50</span></a> including the dashed line marked with (MEALY ONLY). Due to the direct dependence on the inputs, the ouputs of a Mealy machine works one clock cycle in advance of a Moore machine.</p>
<p>A state diagram of a Mealy machine is shown in <a class="reference internal" href="#fig-vhdl-mealy-diagram"><span class="std std-numref">Fig. 2.52</span></a> where the circles represent the current state and the arrows represent the transitions between the different states. Since the output of a Mealy machine is a function of both the current state and the inputs, the output label is associated with the transition arrows.</p>
<figure class="align-center" id="fig-vhdl-mealy-diagram">
<a class="reference internal image-reference" href="../_images/vhdl_mealy_diagram.png"><img alt="../_images/vhdl_mealy_diagram.png" src="../_images/vhdl_mealy_diagram.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.52 </span><span class="caption-text">Mealy state diagram.</span><a class="headerlink" href="#fig-vhdl-mealy-diagram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="design-of-fsms-in-vhdl">
<h2><span class="section-number">2.13.3. </span>Design of FSMs in VHDL<a class="headerlink" href="#design-of-fsms-in-vhdl" title="Permalink to this heading">#</a></h2>
<p>An FSM can be described in VHDL using different approaches. The following examples will show 3 common approaches. They differ mainly by how many process statements are used to describe the logic. An FSM can be implemented entirely in one single synchronous (clocked) process, or it can be split into one synchronous process and one or two combinational processes.</p>
<p><strong>One Process FSM:</strong> Since the current state is stored in memory elements such as registers (flip flops), at least 1 synchronous process is needed to describe a state machine. This synchronous process will then include logic to determine the next state as a function of the inputs, update the current state, and determine the outputs value as a function of the current state (and the inputs for a Mealy machine).</p>
<p><strong>Two process FSM:</strong> For a two process approach it is common to split the output logic into a separate combinational process.  The synchronous process evaluates the inputs and calculates the next state value which then is updated on the next active clock edge.</p>
<p><strong>Three process FSM:</strong> For a three process state machine both the input logic and ouput logic are described in separate combinational processes. The block diagram in figure <a class="reference internal" href="#fig-vhdl-statemachine"><span class="std std-numref">Fig. 2.50</span></a> corresponds well to a three process state machine with one combinational process to calculate the next state, one synchronous process to update and store the current state, and one combinational process to determine the output values.</p>
</section>
<section id="declaration-of-states">
<h2><span class="section-number">2.13.4. </span>Declaration of states<a class="headerlink" href="#declaration-of-states" title="Permalink to this heading">#</a></h2>
<p>We make use of the enumerated data type in VHDL to declare the states. With this data type we can specify a list of legal values that a variable or signal of the defined type may be assigned. This enhances the readability when dealing with state machine descriptions. Instead of defining fixed bit patterns or values for each state, the symbolic names are automatically mapped to a bit level representation during synthesis. For the example shown in <a class="reference internal" href="#fig-vhdl-moore-example-diagram"><span class="std std-numref">Fig. 2.53</span></a> and <a class="reference internal" href="#fig-vhdl-mealy-example-diagram"><span class="std std-numref">Fig. 2.54</span></a> we have three legal states <strong>S0</strong>, <strong>S1</strong>, and <strong>S2</strong>. A new type <code class="docutils literal notranslate"><span class="pre">state_type</span></code> is declared as an enumerated list of symbolic names. We can then declare a signal of this new type, which can be assigned the values specified in the list.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="n">S1</span><span class="p">,</span><span class="n">S2</span><span class="p">);</span>
<span class="k">signal</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>
</pre></div>
</div>
<p>We will demonstrate the one process, two process, and three process implementation using the Moore and Mealy state diagrams in <a class="reference internal" href="#fig-vhdl-moore-example-diagram"><span class="std std-numref">Fig. 2.53</span></a> and <a class="reference internal" href="#fig-vhdl-mealy-example-diagram"><span class="std std-numref">Fig. 2.54</span></a>.</p>
<figure class="align-center" id="fig-vhdl-moore-example-diagram">
<a class="reference internal image-reference" href="../_images/vhdl_moore_example2_diagram.png"><img alt="../_images/vhdl_moore_example2_diagram.png" src="../_images/vhdl_moore_example2_diagram.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.53 </span><span class="caption-text">Moore example state diagram.</span><a class="headerlink" href="#fig-vhdl-moore-example-diagram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="fig-vhdl-mealy-example-diagram">
<a class="reference internal image-reference" href="../_images/vhdl_mealy_example2_diagram.png"><img alt="../_images/vhdl_mealy_example2_diagram.png" src="../_images/vhdl_mealy_example2_diagram.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.54 </span><span class="caption-text">Mealy example state diagram.</span><a class="headerlink" href="#fig-vhdl-mealy-example-diagram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Both examples have the entity declaration shown below.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">entity</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="k">port</span><span class="p">(</span>
<span class="w">    </span><span class="n">clk</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w">  </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">    </span><span class="n">din</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w">  </span><span class="kt">std_logic</span><span class="p">;</span>
<span class="w">    </span><span class="n">dout</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="k">end</span><span class="w"> </span><span class="k">entity</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="one-process-state-machine">
<h2><span class="section-number">2.13.5. </span>One process state machine<a class="headerlink" href="#one-process-state-machine" title="Permalink to this heading">#</a></h2>
<p>The one process state machine are commonly used for simple state machines and implements all the logic inside one synchronous process.</p>
<p><strong>One process Moore</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">moore_oneprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">state_moore</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>

<span class="k">begin</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">state_moore</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>

<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>

<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>One process Mealy</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">mealy_oneprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>

<span class="k">begin</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">state_mealy</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">          </span><span class="n">dout</span><span class="w">        </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">          </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">          </span><span class="n">dout</span><span class="w">        </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">          </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">          </span><span class="n">dout</span><span class="w">        </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">          </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center" id="fig-vhdl-moore-simulation2-1p">
<a class="reference internal image-reference" href="../_images/vhdl_mealy_moore_simulation2_1p.png"><img alt="../_images/vhdl_mealy_moore_simulation2_1p.png" src="../_images/vhdl_mealy_moore_simulation2_1p.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.55 </span><span class="caption-text">Simulation result of a Moore and Mealy machine implemented using one synchronous process. Notice how the ouputs of the Mealy machine changes one clock cycle in advance of the Moore machine.</span><a class="headerlink" href="#fig-vhdl-moore-simulation2-1p" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="two-process-state-machine">
<h2><span class="section-number">2.13.6. </span>Two process state machine<a class="headerlink" href="#two-process-state-machine" title="Permalink to this heading">#</a></h2>
<p>For a two process approach it is common to split the output logic into a separate combinational process.</p>
<p><strong>Two process Moore</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">moore_twoprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">state_moore</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>


<span class="k">begin</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">state_moore</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="n">p_comb_out</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">state_moore</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">state_moore</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Two process Mealy</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">mealy_twoprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>


<span class="k">begin</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">state_mealy</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">          </span><span class="n">state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>


<span class="n">p_comb_out</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">state_mealy</span><span class="p">,</span><span class="w"> </span><span class="n">din</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">state_mealy</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">      </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center" id="fig-vhdl-moore-simulation2-2p">
<a class="reference internal image-reference" href="../_images/vhdl_mealy_moore_simulation2_2p.png"><img alt="../_images/vhdl_mealy_moore_simulation2_2p.png" src="../_images/vhdl_mealy_moore_simulation2_2p.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.56 </span><span class="caption-text">Simulation result of a Moore and Mealy machine implemented using one synchronous process to update the current state and one combinational ouput process. Notice how the ouputs of the Mealy machine changes when the input changes and is one clock cycle in advance of the Moore machine.</span><a class="headerlink" href="#fig-vhdl-moore-simulation2-2p" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Compared to the one process implementation it is worth noticing that the output of the two process implementation changes immediately as a function of the input. The output logic is now implemented in a combinational process and any change on the process’ input signals will reflect immediately on the output. This is not the case for the one process implementation where output logic changes synchronously to the clock. Still for both the one process and two process implementation, the outputs of the Mealy machine changes one clock cycle in advance of the Moore machine.</p>
</section>
<section id="three-process-state-machine">
<h2><span class="section-number">2.13.7. </span>Three process state machine<a class="headerlink" href="#three-process-state-machine" title="Permalink to this heading">#</a></h2>
<p>For the three process implementation we need to declare two signals of the enumerated type.
These two signals will be used by the combinatorial input process to determine the <code class="docutils literal notranslate"><span class="pre">next_state</span></code> value that will be used to update the <code class="docutils literal notranslate"><span class="pre">current_state</span></code> on the next active clock edge.</p>
<p><strong>Three process Moore</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">moore_threeprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">current_state_moore</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">next_state_moore</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>

<span class="k">begin</span>

<span class="n">p_comb_in</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">current_state_moore</span><span class="p">,</span><span class="w"> </span><span class="n">din</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">current_state_moore</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="n">current_state_moore</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">next_state_moore</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="n">p_comb_out</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">current_state_moore</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">current_state_moore</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>


<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Three process Mealy</strong></p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">architecture</span><span class="w"> </span><span class="nc">mealy_threeprocess</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nc">statemachine</span><span class="w"> </span><span class="k">is</span>

<span class="w">  </span><span class="k">type</span><span class="w"> </span><span class="n">state_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">);</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">current_state_mealy</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>
<span class="w">  </span><span class="k">signal</span><span class="w"> </span><span class="n">next_state_mealy</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">state_type</span><span class="p">;</span>


<span class="k">begin</span>

<span class="n">p_comb_in</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">current_state_mealy</span><span class="p">,</span><span class="w"> </span><span class="n">din</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">current_state_mealy</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S1</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S0</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">next_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="n">p_state</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">rising_edge</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="n">current_state_mealy</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">next_state_mealy</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>

<span class="n">p_comb_out</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="p">(</span><span class="n">current_state_mealy</span><span class="p">,</span><span class="w"> </span><span class="n">din</span><span class="p">)</span><span class="w"> </span><span class="k">is</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">current_state_mealy</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S0</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S1</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="n">S2</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">din</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;00&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">dout</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="p">;</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">case</span><span class="p">;</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>


<span class="k">end</span><span class="w"> </span><span class="k">architecture</span><span class="p">;</span>
</pre></div>
</div>
<figure class="align-center" id="fig-vhdl-moore-simulation2-3p">
<a class="reference internal image-reference" href="../_images/vhdl_mealy_moore_simulation2_3p.png"><img alt="../_images/vhdl_mealy_moore_simulation2_3p.png" src="../_images/vhdl_mealy_moore_simulation2_3p.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.57 </span><span class="caption-text">Simulation result of a Moore and Mealy machine implemented using one synchronous process to update the current state, one combinational input process, and one combinational ouput process. Notice how the ouputs of the Mealy machine changes when the input changes and is one clock cycle in advance of the Moore machine.</span><a class="headerlink" href="#fig-vhdl-moore-simulation2-3p" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="info admonition">
<p class="admonition-title">Final remarks</p>
<p>There is no right or wrong choice when deciding on a choice of implementation, both regarding the number of processes to use or whether to use a Moore or Mealy type behaviour. In practice you may implement a state machine that combines a Moore and Mealy behaviour. Some prefer to write the state machine using a single process only as this helps to reduced the risk of unwanted latches and ensures that all outputs are registered. While others prefer to split the state machine into a clocked process to update the state registers and separate combinational processes for the inputs and outputs. During a learning process, this approach may help to better identify what is combintional logic and what is synchronous logic.</p>
</div>
<p>The VHDL code for the examples including a simulation setup can be found <a class="reference external" href="https://github.uio.no/FYS4220/statemachine_example">here</a>.</p>
</section>
<section id="supporting-videos">
<h2><span class="section-number">2.13.8. </span>Supporting videos<a class="headerlink" href="#supporting-videos" title="Permalink to this heading">#</a></h2>
<p>The following video gives and introduction to state machines in VHDL.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/OZn_fk95vvE" title="Introduction to FSM in VHDL" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p>There are different approaches to describing state machines in VHDL. The following videos demonstrates how to describe state machines using a 1-process, 2-process, or 3-process approach. The examples also demonstrates the use of configurations in VHDL.</p>
<p><strong>1-process state machine</strong></p>
<p>The following video demonstrates how to write a 1-process state machine in VHDL.</p>
<div class="video-container">
<iframe width="941" height="587" src="https://www.youtube.com/embed/nbFhOlRvTXg" title="vhdl 1process statemachine" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p>The following video demonstrates the simulation of a 1-process state machine.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/T81iE7mhdiA" title="vhdl 1process statemachine simulation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p><strong>2-process state machine</strong></p>
<p>The following video demonstrates how to write a 2-process state machine in VHDL.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/arDzr61HcGY" title="vhdl 2process statemachine" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p>The following video demonstrates the simulation of a 2-process state machine.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/IcDMVWBvxbA" title="vhdl 2process statemachine simulation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p><strong>3-process state machine</strong></p>
<p>The following video demonstrates how to write and  simulation a 3-process state machine in VHDL.</p>
<div class="video-container">
<iframe width="1920" height="806" src="https://www.youtube.com/embed/leF7IKnbN7s" title="vhdl 3process statemachine" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p>You will find the code use in these examples under the organisation FYS4220 on Github: <a class="github reference external" href="https://github.com/fys4220/fys4220-example-basic-statemachine">fys4220/fys4220-example-basic-statemachine</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part-vhdl"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="vhdl_generics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.12. </span>Generic map</p>
      </div>
    </a>
    <a class="right-next"
       href="vhdl_packages_subprograms.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.14. </span>Packages and subprograms</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moore">2.13.1. Moore</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mealy">2.13.2. Mealy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-of-fsms-in-vhdl">2.13.3. Design of FSMs in VHDL</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declaration-of-states">2.13.4. Declaration of states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-process-state-machine">2.13.5. One process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-process-state-machine">2.13.6. Two process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#three-process-state-machine">2.13.7. Three process state machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supporting-videos">2.13.8. Supporting videos</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ketil Røed
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>